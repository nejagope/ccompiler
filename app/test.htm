<!DOCTYPE html>
<html>
    <head>
        <script src="parser.js"></script>        
        <script src="analyzer.js"></script>  

        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">

        <!-- jQuery library -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

        <!-- Popper JS -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>

        <!-- Latest compiled JavaScript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

              
        <script>

            function compile(){
                var code = $("#txtCode").val();
                
                try{                       
                    var ast = parser.parse(code);                    
                    $("#txtResult").text(JSON.stringify(ast)); 
                    var res = analyzeAST(ast);
                    $("#txtTS").text(JSON.stringify(res.ts));
                    $("#txtErrs").text(JSON.stringify(res.errs));
                                        
                    if (res.errs.length > 0){                        
                        $("#alertFail").fadeTo(2000, 500).slideUp(1000, function(){
                            $("#alertFail").slideUp(500);
                        });
                        $("#alertSuccess").hide();
                    }else{
                        $("#alertSuccess").fadeTo(2000, 500).slideUp(1000, function(){
                            $("#alertSuccess").slideUp(500);
                        });
                        $("#alertFail").hide();
                    }
                    
                }catch(ex){
                    $("#txtResult").text(ex);
                }                
            }
        </script>
    </head>

    <bod>
        <div class="container">

            <div class="row">                
                <div class="col-md-12">
                    <hr>
                    <h2>C Compliler</h2>
                    <p>Write your code and compile it...</p>
                    <hr>
                </div>
            </div>

            <div class="row">
                <div class="col-md-12">
                    <button class="btn btn-primary" onclick="compile()">Compile</button>
                    <a href="http://json.parser.online.fr/" target="_blank" class="btn btn-link">JSON Parser</a>
                    <hr>

                    <div class="alert alert-success alert-dismissible" role="alert" id="alertSuccess"  data-dismiss="alert" aria-hidden="true">                        
                        <h6 class="alert-heading">
                            Success!
                        </h6>
                        <p>Compiled without errors</p>                           
                    </div>

                    <div class="alert alert-danger alert-dismissible" role="alert" id="alertFail"  data-dismiss="alert" aria-hidden="true">                        
                        <h6 class="alert-heading">
                            Failed!
                        </h6>
                        <p>Compiled with <a href="#txtErrs" class="alert-link">errors</a></p>                           
                    </div>

                    <script>
                            $("#alertSuccess").hide();
                            $("#alertFail").hide();
                    </script>

                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <textarea id="txtCode" rows="30" cols="100" class="form-control"></textarea>
                </div>
            
                <div class="col-md-6">
                    <textarea id="txtResult" rows="30" cols="100" class="form-control"></textarea>
                </div>
            </div>

            <div class="row">
                <div class="col-md-12">
                    <h3>Symbols</h3>
                    <textarea id="txtTS" rows="10" cols="200" class="form-control"></textarea>
                </div>            
            </div>

            <div class="row">
                <div class="col-md-12">
                    <h3>Errors</h3>
                    <textarea id="txtErrs" rows="10" cols="200" class="form-control"></textarea>
                </div>            
            </div>
            
        </div>
    
    </bod>
</html>